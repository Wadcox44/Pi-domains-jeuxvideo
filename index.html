<!DOCTYPE html>
<html>
<head>
    <title>Jeux Video Portal</title>
    <script src="https://sdk.minepi.com/pi-sdk.js"></script>
    <style>
        body { background: #1a1a1a; color: white; text-align: center; font-family: sans-serif; }
        iframe { width: 100%; height: 500px; border: none; margin-top: 20px; }
        #pay-section { background: #333; padding: 20px; border-radius: 10px; margin: 20px; }
        button { background: #ffaa00; color: black; border: none; padding: 15px 30px; font-weight: bold; cursor: pointer; border-radius: 5px; }
    </style>
</head>
<body>

    <h1>Bienvenue sur Jeux Video Portal</h1>
    
    <div id="pay-section">
        <p id="status-box">Initialisation du système...</p>
        <button id="pay_button">Donner 1 Pi pour le projet</button>
    </div>

    <iframe src="https://play2048.co/"></iframe>

    <script>
        const Pi = window.Pi;
        Pi.init({ version: "2.0", sandbox: true });

        async function initApp() {
            try {
                const auth = await Pi.authenticate(['payments', 'username'], function(p){});
                document.getElementById('status-box').innerHTML = "Connecté : " + auth.user.username;
            } catch (err) {
                document.getElementById('status-box').innerHTML = "Prêt (mode test)";
            }
        }

        document.getElementById('pay_button').onclick = async function() {
            try {
                const payment = await Pi.createPayment({
                    amount: 1,
                    memo: "Soutien au portail",
                    metadata: { type: "donation" },
                }, {
                    onReadyForServerApproval: (id) => alert("Paiement envoyé ! ID: " + id),
                    onReadyForServerCompletion: (id, tx) => alert("Merci !"),
                    onCancel: (id) => alert("Annulé"),
                    onError: (e) => alert("Erreur SDK: " + e.message)
                });
            } catch (e) {
                alert("Erreur critique : " + e.message);
            }
        };

        initApp();
    </script>
</body>
</html>
